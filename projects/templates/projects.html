{% extends 'base.html' %}
{% load static %}

{% block title %}–ü—Ä–æ–µ–∫—Ç—ã | –ö—Ä–∞—É–¥—Ñ–∞–Ω–¥–∏–Ω–≥. –ë—É–¥—É—â–µ–µ.{% endblock %}

{% block content %}

<!-- –®–∞–ø–∫–∞ -->
<header class="navbar">
    <a href="{% url 'projects:index' %}" class="logo-link">
        <img src="{% static 'Image/s.png' %}" alt="s" class="stakeup">
    </a>
    <a href="{% url 'projects:index' %}">–ì–ª–∞–≤–Ω–∞—è</a>
    <a href="{% url 'projects:about' %}">–û –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ</a>
    <a href="{% url 'projects:projects_list' %}">–ü—Ä–æ–µ–∫—Ç—ã</a>
    <a href="{% url 'projects:login' %}">–í—Ö–æ–¥/–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a>
</header>

<div class="page">
    <!-- –§–∏–ª—å—Ç—Ä—ã -->
    <div class="filters-section">
        <div class="filters-container" style="margin-top: 20px;">
            <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ -->
            <div class="filter-group">
                <h3 class="filter-title">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</h3>
                <div class="filter-chips">
                    <button class="chip chip-active" data-filter="all">–í—Å–µ</button>
                    <button class="chip" data-filter="social">–°–æ—Ü–∏–∞–ª—å–Ω—ã–µ</button>
                    <button class="chip" data-filter="eco">–≠–∫–æ–ª–æ–≥–∏—è</button>
                    <button class="chip" data-filter="edu">–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ</button>
                    <button class="chip" data-filter="art">–ò—Å–∫—É—Å—Å—Ç–≤–æ</button>
                    <button class="chip" data-filter="tech">–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏</button>
                </div>
            </div>

            <!-- –°—Ç–∞—Ç—É—Å -->
            <div class="filter-group">
                <h3 class="filter-title">–°—Ç–∞—Ç—É—Å</h3>
                <div class="filter-chips">
                    <button class="chip chip-active" data-filter="status-all">–í—Å–µ</button>
                    <button class="chip" data-filter="status-active">–ê–∫—Ç–∏–≤–Ω—ã–µ</button>
                    <button class="chip" data-filter="status-success">–£—Å–ø–µ—à–Ω—ã–µ</button>
                    <button class="chip" data-filter="status-expired">–ü—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–µ</button>
                </div>
            </div>

            <!-- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ (–∫–∞—Å—Ç–æ–º–Ω—ã–π dropdown) -->
            <div class="filter-group">
                <h3 class="filter-title">–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞</h3>
                <div class="filter-chips">
                    <button class="chip chip-active" data-sort="popular">–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ</button>
                    <button class="chip" data-sort="newest">–ù–æ–≤—ã–µ</button>
                    <button class="chip" data-sort="deadline">–ë–ª–∏–∂–∞–π—à–∏–π –¥–µ–¥–ª–∞–π–Ω</button>
                    <button class="chip" data-sort="funded">–ë–æ–ª—å—à–µ —Å–æ–±—Ä–∞–Ω–æ</button>
                    <button class="chip" data-sort="needed">–ú–µ–Ω—å—à–µ –æ—Å—Ç–∞–ª–æ—Å—å</button>
                </div>
            </div>
        </div>
    </div>

    <!-- –°–∫—Ä–∏–ø—Ç —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ -->
    <script>
document.addEventListener('DOMContentLoaded', function() {
    const chips = document.querySelectorAll('.chip[data-filter], .chip[data-sort]');
    const cards = document.querySelectorAll('.project-card');
    
    // === –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏/—Å—Ç–∞—Ç—É—Å—É –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ ===
    chips.forEach(chip => {
        chip.addEventListener('click', () => {
            // Handle active state for chips
            const group = chip.closest('.filter-chips');
            group.querySelectorAll('.chip').forEach(c => c.classList.remove('chip-active'));
            chip.classList.add('chip-active');

            // Get current filters
            const catFilter = document.querySelector('.filter-group:nth-of-type(1) .chip-active')?.dataset.filter || 'all';
            const statFilter = document.querySelector('.filter-group:nth-of-type(2) .chip-active')?.dataset.filter || 'status-all';
            const sortOption = document.querySelector('.filter-group:nth-of-type(3) .chip-active')?.dataset.sort || 'popular';

            // Apply filtering
            cards.forEach(card => {
                const cat = card.dataset.category;
                const stat = card.dataset.status;
                const show = (catFilter === 'all' || catFilter === cat) &&
                             (statFilter === 'status-all' || statFilter === `status-${stat}`);
                card.style.display = show ? 'flex' : 'none';
            });
            
            // Apply sorting
            sortVisibleCards(sortOption);
        });
    });

    // Function to sort visible cards
    function sortVisibleCards(sortOption) {
        // Get all visible cards
        const visibleCards = Array.from(cards).filter(card => card.style.display !== 'none');
        
        // Sort based on option
        visibleCards.sort((a, b) => {
            switch(sortOption) {
                case 'funded':
                    // Sort by amount funded (highest first)
                    const aFunded = parseFloat(a.querySelector('.collected').textContent.replace(/\D/g, ''));
                    const bFunded = parseFloat(b.querySelector('.collected').textContent.replace(/\D/g, ''));
                    return bFunded - aFunded;
                case 'needed':
                    // Sort by remaining amount (lowest first)
                    const aGoal = parseFloat(a.querySelector('.goal').textContent.replace(/\D/g, ''));
                    const aCollected = parseFloat(a.querySelector('.collected').textContent.replace(/\D/g, ''));
                    const bGoal = parseFloat(b.querySelector('.goal').textContent.replace(/\D/g, ''));
                    const bCollected = parseFloat(b.querySelector('.collected').textContent.replace(/\D/g, ''));
                    
                    const aRemaining = aGoal - aCollected;
                    const bRemaining = bGoal - bCollected;
                    
                    return aRemaining - bRemaining;
                case 'deadline':
                    // Sort by deadline (closest first)
                    // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –ø–æ –¥–µ–¥–ª–∞–π–Ω—É
                    return 0;
                case 'newest':
                    // Sort by date (newest first)
                    // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –ø–æ –¥–∞—Ç–µ
                    return 0;
                default:
                    // Default to original order
                    return 0;
            }
        });
        
        // Reinsert sorted cards into the grid
        const grid = document.querySelector('.projects-grid');
        visibleCards.forEach(card => {
            grid.appendChild(card);
        });
    }
});
</script>

    <!-- –ü—Ä–æ–µ–∫—Ç—ã -->
    <div class="projects-grid">
        <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ 1 -->
        <div class="project-card" data-category="eco" data-status="active">
            <div class="project-text">
                <div class="project-meta">
                    <span class="badge badge-eco">üåø –≠–∫–æ–ª–æ–≥–∏—è</span>
                    <span class="badge badge-days">–æ—Å—Ç–∞–ª–æ—Å—å 24 –¥–Ω—è</span>
                </div>
                <h3 class="project-name">–≠–∫–æ-–ø–∞—Ä–∫ ¬´–ó–µ–ª—ë–Ω—ã–π –õ–∏—Å—Ç¬ª</h3>
                <p class="project-slogan">–°–æ–∑–¥–∞–¥–∏–º –ø–µ—Ä–≤—ã–π –≥–æ—Ä–æ–¥—Å–∫–æ–π –ª–µ—Å –≤ —Ü–µ–Ω—Ç—Ä–µ –º–µ–≥–∞–ø–æ–ª–∏—Å–∞</p>
                <div class="project-progress">
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 68%"></div>
                    </div>
                    <div class="progress-stats">
                        <span class="collected">1 360 000 ‚ÇΩ</span>
                        <span class="goal">–∏–∑ 2 000 000 ‚ÇΩ</span>
                    </div>
                </div>
                <div class="project-buttons">
                    <a href="{% url 'projects:project_detail' 1 %}" class="btn btn-primary btn-small">–£–∑–Ω–∞—Ç—å –±–æ–ª—å—à–µ</a>
                    <a href="{% url 'projects:donate' 1 %}" class="btn btn-secondary btn-small">–ü–æ–∂–µ—Ä—Ç–≤–æ–≤–∞—Ç—å</a>
                </div>
            </div>
            <div class="project-image">
                <img src="{% static 'Image/greenpark.png' %}" alt="–≠–∫–æ-–ø–∞—Ä–∫">
            </div>
        </div>

        <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ 2 -->
        <div class="project-card" data-category="edu" data-status="success">
            <div class="project-text">
                <div class="project-meta">
                    <span class="badge badge-edu">üéì –û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ</span>
                    <span class="badge badge-success">‚úÖ –£—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à—ë–Ω</span>
                </div>
                <h3 class="project-name">–®–∫–æ–ª–∞ –±—É–¥—É—â–µ–≥–æ</h3>
                <p class="project-slogan">–ë–µ—Å–ø–ª–∞—Ç–Ω–æ–µ IT-–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –¥–ª—è –¥–µ—Ç–µ–π –∏–∑ –º–∞–ª—ã—Ö –≥–æ—Ä–æ–¥–æ–≤</p>
                <div class="project-progress">
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 100%"></div>
                    </div>
                    <div class="progress-stats">
                        <span class="collected">5 200 000 ‚ÇΩ</span>
                        <span class="goal">–∏–∑ 5 000 000 ‚ÇΩ</span>
                    </div>
                </div>
                <div class="project-buttons">
                    <a href="{% url 'projects:project_detail' 2 %}" class="btn btn-primary btn-small">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</a>
                    <a href="#" class="btn btn-disabled btn-small" disabled>–ó–∞–≤–µ—Ä—à—ë–Ω</a>
                </div>
            </div>
            <div class="project-image">
                <img src="{% static 'Image/school.png' %}" alt="–®–∫–æ–ª–∞">
            </div>
        </div>

        <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ 3 -->
        <div class="project-card" data-category="social" data-status="active">
            <div class="project-text">
                <div class="project-meta">
                    <span class="badge badge-social">ü§ù –°–æ—Ü–∏–∞–ª—å–Ω—ã–µ</span>
                    <span class="badge badge-days">–æ—Å—Ç–∞–ª–æ—Å—å 8 –¥–Ω–µ–π</span>
                </div>
                <h3 class="project-name">–ú–æ—Å—Ç –Ω–∞–¥–µ–∂–¥—ã</h3>
                <p class="project-slogan">–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏–º –º–æ—Å—Ç –≤ –æ—Ç–¥–∞–ª—ë–Ω–Ω–æ–º —Å–µ–ª–µ ‚Äî –≤–µ—Ä–Ω—ë–º —Å–≤—è–∑—å —Å –º–∏—Ä–æ–º</p>
                <div class="project-progress">
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 92%"></div>
                    </div>
                    <div class="progress-stats">
                        <span class="collected">828 000 ‚ÇΩ</span>
                        <span class="goal">–∏–∑ 900 000 ‚ÇΩ</span>
                    </div>
                </div>
                <div class="project-buttons">
                    <a href="{% url 'projects:project_detail' 3 %}" class="btn btn-primary btn-small">–£–∑–Ω–∞—Ç—å –±–æ–ª—å—à–µ</a>
                    <a href="{% url 'projects:donate' 3 %}" class="btn btn-secondary btn-small">–ü–æ–∂–µ—Ä—Ç–≤–æ–≤–∞—Ç—å</a>
                </div>
            </div>
            <div class="project-image">
                <img src="{% static 'Image/bridge.png' %}" alt="–ú–æ—Å—Ç">
            </div>
        </div>

        <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ 4 -->
        <div class="project-card" data-category="art" data-status="active">
            <div class="project-text">
                <div class="project-meta">
                    <span class="badge badge-art">üé® –ò—Å–∫—É—Å—Å—Ç–≤–æ</span>
                    <span class="badge badge-days">–æ—Å—Ç–∞–ª–æ—Å—å 41 –¥–Ω—è</span>
                </div>
                <h3 class="project-name">–ê—Ä—Ç-—Ä–µ–∑–∏–¥–µ–Ω—Ü–∏—è</h3>
                <p class="project-slogan">–ü–æ–¥–¥–µ—Ä–∂–∏–º –º–æ–ª–æ–¥—ã—Ö —Ö—É–¥–æ–∂–Ω–∏–∫–æ–≤ –∏ –∏—Ö —Å–º–µ–ª—ã–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã</p>
                <div class="project-progress">
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 27%"></div>
                    </div>
                    <div class="progress-stats">
                        <span class="collected">270 000 ‚ÇΩ</span>
                        <span class="goal">–∏–∑ 1 000 000 ‚ÇΩ</span>
                    </div>
                </div>
                <div class="project-buttons">
                    <a href="{% url 'projects:project_detail' 4 %}" class="btn btn-primary btn-small">–£–∑–Ω–∞—Ç—å –±–æ–ª—å—à–µ</a>
                    <a href="{% url 'projects:donate' 4 %}" class="btn btn-secondary btn-small">–ü–æ–∂–µ—Ä—Ç–≤–æ–≤–∞—Ç—å</a>
                </div>
            </div>
            <div class="project-image">
                <img src="{% static 'Image/art.png' %}" alt="–†–µ–∑–∏–¥–µ–Ω—Ü–∏—è">
            </div>
        </div>

        <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ 5 -->
        <div class="project-card" data-category="tech" data-status="active">
            <div class="project-text">
                <div class="project-meta">
                    <span class="badge badge-tech">üöÄ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏</span>
                    <span class="badge badge-days">–æ—Å—Ç–∞–ª–æ—Å—å 15 –¥–Ω–µ–π</span>
                </div>
                <h3 class="project-name">OpenMed ‚Äî –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –¥–ª—è –≤—Å–µ—Ö</h3>
                <p class="project-slogan">AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –¥–ª—è –ø–µ—Ä–≤–∏—á–Ω–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –≤ –æ—Ç–¥–∞–ª—ë–Ω–Ω—ã—Ö —Ä–µ–≥–∏–æ–Ω–∞—Ö</p>
                <div class="project-progress">
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 43%"></div>
                    </div>
                    <div class="progress-stats">
                        <span class="collected">860 000 ‚ÇΩ</span>
                        <span class="goal">–∏–∑ 2 000 000 ‚ÇΩ</span>
                    </div>
                </div>
                <div class="project-buttons">
                    <a href="{% url 'projects:project_detail' 5 %}" class="btn btn-primary btn-small">–£–∑–Ω–∞—Ç—å –±–æ–ª—å—à–µ</a>
                    <a href="{% url 'projects:donate' 5 %}" class="btn btn-secondary btn-small">–ü–æ–∂–µ—Ä—Ç–≤–æ–≤–∞—Ç—å</a>
                </div>
            </div>
            <div class="project-image">
                <img src="{% static 'Image/ai.png' %}" alt="AI-–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞">
            </div>
        </div>

        <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ 6 -->
        <div class="project-card" data-category="social" data-status="expired">
            <div class="project-text">
                <div class="project-meta">
                    <span class="badge badge-social">ü§ù –°–æ—Ü–∏–∞–ª—å–Ω—ã–µ</span>
                    <span class="badge badge-expired">‚ùå –ù–µ –Ω–∞–±—Ä–∞–Ω–æ</span>
                </div>
                <h3 class="project-name">–ü—Ä–∏—é—Ç –¥–ª—è –±–µ–∑–¥–æ–º–Ω—ã—Ö –∂–∏–≤–æ—Ç–Ω—ã—Ö</h3>
                <p class="project-slogan">–°—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ –Ω–æ–≤–æ–≥–æ –∫–æ—Ä–ø—É—Å–∞ –ø—Ä–∏—é—Ç–∞ –≤ –ü–æ–¥–º–æ—Å–∫–æ–≤—å–µ</p>
                <div class="project-progress">
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: 35%"></div>
                    </div>
                    <div class="progress-stats">
                        <span class="collected">700 000 ‚ÇΩ</span>
                        <span class="goal">–∏–∑ 2 000 000 ‚ÇΩ</span>
                    </div>
                </div>
                <div class="project-buttons">
                    <a href="{% url 'projects:project_detail' 6 %}" class="btn btn-primary btn-small">–ò—Å—Ç–æ—Ä–∏—è –ø—Ä–æ–µ–∫—Ç–∞</a>
                    <a href="#" class="btn btn-disabled btn-small" disabled>–û–∫–æ–Ω—á–µ–Ω</a>
                </div>
            </div>
            <div class="project-image">
                <img src="{% static 'Image/pets.png' %}" alt="–ü—Ä–∏—é—Ç">
            </div>
        </div>
    </div>

    <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è -->
    <div class="pagination">
        <a href="#" class="btn btn-secondary">&laquo; –ù–∞–∑–∞–¥</a>
        <span class="page-num active">1</span>
        <a href="#" class="page-num">2</a>
        <a href="#" class="page-num">3</a>
        <a href="#" class="btn btn-secondary">–í–ø–µ—Ä—ë–¥ &raquo;</a>
    </div>
</div>

<!-- –§—É—Ç–µ—Ä -->
<footer class="site-footer">
    <div class="footer-container">
        <div class="footer-brand">
            <img src="{% static 'Image/s.png' %}" alt="–õ–æ–≥–æ—Ç–∏–ø" class="footer-logo">
            <p class="footer-slogan">–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∏–¥–µ–π –∏ –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤</p>
        </div>
        <div class="footer-links">
            <div class="footer-column">
                <h3 class="footer-title">–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞</h3>
                <ul>
                    <li><a href="{% url 'projects:about' %}">–û –Ω–∞—Å</a></li>
                    <li><a href="{% url 'projects:projects_list' %}">–ü—Ä–æ–µ–∫—Ç—ã</a></li>
                </ul>
            </div>
            <div class="footer-column">
                <h3 class="footer-title">–ü–æ–¥–¥–µ—Ä–∂–∫–∞</h3>
                <ul>
                    <li><a href="#faq">FAQ</a></li>
                    <li><a href="{% url 'projects:login' %}">–ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å –ø—Ä–æ–µ–∫—Ç?</a></li>
                </ul>
            </div>
            <div class="footer-column">
                <h3 class="footer-title">–°–æ—Ü—Å–µ—Ç–∏</h3>
                <ul>
                    <li><a href="https://t.me/drbshh" target="_blank">Telegram</a></li>
                </ul>
            </div>
        </div>
    </div>
    <div class="footer-bottom">
        <p>&copy; 2025 –ö—Ä–∞—É–¥—Ñ–∞–Ω–¥–∏–Ω–≥. –ë—É–¥—É—â–µ–µ. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
    </div>
</footer>

{% endblock %}